<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro Kidoo</title>
  <link rel="stylesheet" href="register.css">
  <link href="https://fonts.googleapis.com/css2?family=ABeeZee:ital@0;1&display=swap" rel="stylesheet">
</head>
<body>
  <form id="registerForm">
    <img src="icono/logo.png" alt="Kidoo" height="120" width="120" style="display:block;margin:auto;margin-bottom:18px;">
    <h2>Registro</h2>

    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre" required>

    <label>Género:</label>
    <div class="genero-perfil">
      <label>
        <input type="radio" name="genero" value="masculino" id="generoMasculino" checked>
        <img src="imagen/boy.png" alt="Perfil masculino">
        <span>Masculino</span>
      </label>
      <label>
        <input type="radio" name="genero" value="femenino" id="generoFemenino">
        <img src="imagen/girl.png" alt="Perfil femenino">
        <span>Femenino</span>
      </label>
    </div>

    <label for="password">Contraseña:</label>
    <input type="password" id="password" name="password" required>

    <label for="contacts">Contactos (elige con quién puede hablar):</label>
    <div id="contactsList">
      <label><input type="checkbox" value="Abuelito José" data-avatar="imagen/Abuelo.png"> Abuelito José</label>
      <label><input type="checkbox" value="Tía Marta" data-avatar="imagen/tia.png"> Tía Marta</label>
      <label><input type="checkbox" value="Hermano Luis" data-avatar="imagen/hermano.png"> Hermano Luis</label>
    </div>

    <div class="nuevo-contacto">
      <div style="flex:2;">
        <label>Nuevo contacto:</label>
        <input type="text" id="nuevoNombre" placeholder="Nombre">
      </div>
      <div style="flex:2;">
        <label>Avatar para el contacto:</label>
        <select id="nuevoAvatar">
          <option value="icono/boy.png">Avatar niño</option>
          <option value="icono/girl.png">Avatar niña</option>
          <option value="imagen/Abuelo.png">Abuelo</option>
          <option value="imagen/tia.png">Tía</option>
          <option value="imagen/hermano.png">Hermano</option>
        </select>
      </div>
      <div style="flex:1;display:flex;align-items:end;">
        <button type="button" class="btn-agregar-contacto" onclick="agregarContacto()">Agregar</button>
      </div>
    </div>

    <button type="submit" class="btn-crear-usuario">Crear usuario</button>
  </form>

  <script>
    function agregarContacto() {
      const nombre = document.getElementById('nuevoNombre').value.trim();
      const avatar = document.getElementById('nuevoAvatar').value;
      if (!nombre) return;
      const contactsList = document.getElementById('contactsList');
      const label = document.createElement('label');
      label.innerHTML = `<input type="checkbox" value="${nombre}" data-avatar="${avatar}"> ${nombre}`;
      contactsList.appendChild(label);
      document.getElementById('nuevoNombre').value = '';
    }

    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const nombre = document.getElementById('nombre').value;
      const genero = document.querySelector('input[name="genero"]:checked').value;
      const avatar = genero === 'masculino' ? 'icono/boy.png' : 'icono/girl.png';
      const password = document.getElementById('password').value;

      const contactos = [];
      document.querySelectorAll('#contactsList input[type="checkbox"]:checked').forEach(cb => {
        contactos.push({
          nombre: cb.value,
          avatar: cb.getAttribute('data-avatar')
        });
      });

      localStorage.setItem('usuario', JSON.stringify({nombre, genero, avatar, password}));
      localStorage.setItem('contactos', JSON.stringify(contactos));

      window.location.href = "login.html";
    });
  </script>
</body>
</html>
